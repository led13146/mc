<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>请在外部浏览器打开</title>
    <script>
        // 精准检测QQ内置环境（包含所有QQ相关内核）
        function isQQInnerBrowser() {
            const ua = navigator.userAgent.toLowerCase();
            return ua.includes('qqbrowser') && !ua.includes('chrome') ||  // 纯QQ浏览器
                   ua.includes('mqqbrowser') && ua.includes('tencent') || // 移动QQ内置浏览器
                   ua.includes('qq/') && !ua.includes('safari'); // QQ客户端WebView
        }

        // 核心跳转函数：强制唤起系统浏览器
        function forceOpenExternalBrowser() {
            const targetUrl = "mc.html"; // 替换为你的目标链接
            const tips = document.getElementById('tips');

            if (isQQInnerBrowser()) {
                // 方案1：利用QQ的协议漏洞强制跳出（成功率最高）
                if (typeof window !== 'undefined') {
                    // 创建隐藏的iframe触发外部协议跳转
                    const iframe = document.createElement('iframe');
                    iframe.style.display = 'none';
                    iframe.src = `weixin://dl/business/?t=xxxxxx`; // 用无关协议触发浏览器唤醒
                    document.body.appendChild(iframe);
                    
                    // 延迟后立即执行实际跳转
                    setTimeout(() => {
                        // 关键：使用location.replace强制替换历史记录，避免回退到QQ浏览器
                        window.location.replace(targetUrl);
                        tips.textContent = "正在唤醒系统浏览器... 若弹出选择框请选默认浏览器";
                    }, 300);

                    // 备用方案：2秒后再次尝试
                    setTimeout(() => {
                        // 创建a标签并指定_system属性（强制系统浏览器）
                        const a = document.createElement('a');
                        a.href = targetUrl;
                        a.setAttribute('target', '_system');
                        a.style.display = 'none';
                        document.body.appendChild(a);
                        a.click();
                    }, 2000);
                }
            } else {
                // 非QQ环境直接跳转
                window.location.href = targetUrl;
            }
        }

        // 页面加载后检测环境并提示
        window.onload = function() {
            if (isQQInnerBrowser()) {
                document.querySelector('.warning').style.display = 'block';
            }
        };
    </script>
    <style>
        body {
            margin: 0;
            padding: 20px;
            min-height: 100vh;
            background: #f8f9fa;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-family: system-ui, sans-serif;
            text-align: center;
        }
        .warning {
            background: #fff3cd;
            color: #856404;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 30px;
            font-size: 14px;
            display: none;
            width: 80%;
        }
        .title {
            font-size: 20px;
            color: #dc3545;
            margin-bottom: 20px;
            font-weight: bold;
        }
        .desc {
            color: #495057;
            font-size: 15px;
            margin-bottom: 40px;
            line-height: 1.6;
            width: 80%;
        }
        .jump-btn {
            width: 80%;
            max-width: 300px;
            padding: 14px 0;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 17px;
            font-weight: 500;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0,123,255,0.2);
            transition: all 0.3s;
        }
        .jump-btn:active {
            background: #0056b3;
            transform: scale(0.98);
        }
        #tips {
            margin-top: 25px;
            color: #6c757d;
            font-size: 13px;
        }
    </style>
</head>
<body>
    <div class="warning">⚠️ 检测到您正在QQ内部浏览器中，功能受限</div>
    <div class="title">请使用手机自带浏览器打开</div>
    <div class="desc">
        点击下方按钮后，若弹出选择框，请选择手机默认浏览器（如Chrome、Safari、华为浏览器等）
    </div>
    <button class="jump-btn" onclick="forceOpenExternalBrowser()">
        点击唤起系统浏览器
    </button>
    <div id="tips">点击后请耐心等待2-3秒</div>
</body>
</html>